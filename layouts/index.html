{{ define "main" }}
    {{- with .Params.hero }}
        <section class="hero-block">
            {{- with .image }}
                <div class="hero-image">
                    <img src="{{ . | relURL }}" alt="講習の紹介イメージ" loading="lazy" width="1600" height="720">
                </div>
            {{- end }}
            <div class="hero-text">
                {{- with .headline }}
                    <h1>{{ . }}</h1>
                {{- end }}
                {{- range .body }}
                    <p>{{ . }}</p>
                {{- end }}
            </div>
        </section>
    {{- end }}

    {{- $taxonomy := site.GetPage "taxonomyTerm" "categories" -}}
    {{- $terms := slice -}}
    {{- if $taxonomy -}}
        {{- $terms = sort $taxonomy.Pages "Weight" -}}
    {{- end -}}

    {{- if gt (len $terms) 0 -}}
        {{- $groups := slice
            (dict "id" 1 "title" "グループ1")
            (dict "id" 2 "title" "グループ2")
            (dict "id" 3 "title" "グループ3")
        -}}
        <div class="category-groups">
            {{- range $group := $groups -}}
                {{- $entries := sort (where $terms "Params.group" $group.id) "Weight" -}}
                {{- if gt (len $entries) 0 -}}
                    <section class="subsection-list category-group">
                        <h2 class="section-title">{{ $group.title }}</h2>
                        <div class="article-list--tile">
                            {{- range $entries -}}
                                {{ partial "article-list/tile" (dict "context" . "size" "250x150" "Type" "taxonomy") }}
                            {{- end -}}
                        </div>
                    </section>
                {{- end -}}
            {{- end -}}
        </div>
    {{- else -}}
        {{/* Fallback to the default posts list if no categories exist */}}
        {{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
        {{ $notHidden := where .Site.RegularPages "Params.hidden" "!=" true }}
        {{ $filtered := ($pages | intersect $notHidden) }}
        {{ $pag := .Paginate ($filtered) }}

        <section class="article-list">
            {{ range $pag.Pages }}
                {{ partial "article-list/default" . }}
            {{ end }}
        </section>

        {{- partial "pagination.html" . -}}
    {{- end -}}

    {{- partial "footer/footer" . -}}
{{ end }}

{{ define "right-sidebar" }}
    {{ partial "sidebar/right.html" (dict "Context" . "Scope" "homepage") }}
{{ end }}
